{"blocks":[{"type":"codeTool","data":{"codeData":{"value":"md`# Broadcast Channel\n\nThe [Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast_Channel_API) can be used to send messages between notebooks. Try opening this notebook in multiple tabs and then editing the text below or dragging the slider. (Note: this API is not currently supported by Safari, but the Message Channel API could perhaps be used to similar effect.)`","pinCode":false,"dname":"a765691c-ac35-48f8-8580-1cace1ddf9dd","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof foo = (synchronize(channel, html`<input name=\"foo\" value=\"Edit me!\">`))","pinCode":false,"dname":"932657c2-fb0b-4774-8a55-45a40436400a","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof bar = (synchronize(channel, html`<input name=\"bar\" type=range>`))","pinCode":false,"dname":"6428fc35-815e-499d-86b1-614ce060bafb","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"[foo, bar]","pinCode":false,"dname":"d0b0fd2e-e137-45b0-85bc-91278e267440","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"synchronize = (function synchronize(channel, input) {\n  function receive(event) {\n    if (event.data.type === \"hello\") {\n      send(event);\n    } else if (event.data.name === input.name && input.value !== event.data.value) {\n      input.value = event.data.value;\n      input.dispatchEvent(new CustomEvent(\"input\"));\n    }\n  }\n  function send(event) {\n    if (!event.isTrusted) return;\n    channel.postMessage({name: input.name, value: input.value});\n  }\n  input.addEventListener(\"input\", send);\n  channel.addEventListener(\"message\", receive);\n  channel.postMessage({type: \"hello\"});\n  return Generators.disposable(input, () => {\n    input.removeEventListener(\"input\", send);\n    channel.removeEventListener(\"message\", receive);\n  });\n})","pinCode":false,"dname":"69dfb952-73d4-4dd2-a101-8a8a976588e5","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"channel = {\n  const channel = new BroadcastChannel(\"example\");\n  invalidation.then(() => channel.close());\n  return channel;\n}","pinCode":false,"dname":"313abd86-49b6-4f62-8998-4889fd86539a","codeMode":"javascript2"}}}],"version":"2.19.1"}