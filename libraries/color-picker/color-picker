{"blocks":[{"type":"codeTool","data":{"codeData":{"value":"md`# Color Picker (with alpha)\n<i>\\`<input type=color>\\` doesn't support [alpha](https://github.com/w3c/html/issues/1422), so here's [Pickr](https://github.com/Simonwep/pickr) trimmed down for Observable.</i>\n`","pinCode":false,"dname":"5c43f9c8-1492-4356-aeba-9f2776031fd6","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"md`\n\\`\\`\\`js\nimport {colorPicker} from \"@shaunlebron/color-picker\"\n\\`\\`\\`\n`","pinCode":false,"dname":"001c1f82-fde9-4745-8c9d-2ded8b5f9ba1","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof nameExample = (colorPicker(\"steelblue\"))","pinCode":false,"dname":"f827315c-fc0a-42d7-a4b2-c4321a198aa3","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof hexExample = (colorPicker(\"#eee\"))","pinCode":false,"dname":"9e3f303f-6ea2-4a32-a902-dccc58ae8fd6","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof rgbExample = (colorPicker(\"rgb(219, 44, 44)\"))","pinCode":false,"dname":"b1871011-a7fb-4987-854a-732e16738486","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof rgbaExample = (colorPicker(\"rgba(64, 161, 0, 0.77)\"))","pinCode":false,"dname":"536b63a9-1210-412a-868b-7ada811e056e","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof hslExample = (colorPicker(\"hsl(220, 53%, 43%)\"))","pinCode":false,"dname":"28125f87-18a8-4272-899f-868d3596ad6c","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof hsvaExample = (colorPicker(\"hsva(240, 69%, 66%, 0.4)\"))","pinCode":false,"dname":"596e7910-48af-4e90-9f37-20471b06a78a","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"md`## Formatting\n- Color string is formatted according to the initial value (first arg).\n- Optionally pass an explicit [TinyColor format string](https://github.com/bgrins/TinyColor#tostring) as second arg.\n  - e.g. \\`\"hex\", \"rgb\", \"hsl\", \"hsv\", \"name\"\\`\n\n## Known issues\n- Pickr seems to be lossy\n  - i.e. moving the knobs to original position may not return original value\n- Pickr modal is occluded by expanded cells.\n- Trying to adjust Pickr modal size (width,height,padding) throws off the knob positions, so we're stuck with the default.\n`","pinCode":false,"dname":"5e4e1a12-ade8-4b0a-8694-23ce25b30f6e","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"md`## Code`","pinCode":false,"dname":"2b55adb4-2bb0-43d0-83a9-30813fe876dd","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"colorPicker = (function colorPicker(defaultValue, format) {\n  // Set desired color format.\n  format = format || tinycolor(defaultValue).getFormat();\n\n  // Build container element.\n  const container = html`\n  <div style=\"height:2.4em;\">\n    ${styles}\n    <div id=\"picker\"></div>\n    <code id=\"label\" style=\"margin-left: 0.5em;\"></code>\n  </div>`;\n  const picker = container.querySelector(\"#picker\");\n  const label = container.querySelector(\"#label\");\n\n  // Set color value.\n  const setValue = colorStr => {\n    // Create color object from string.\n    const color = tinycolor(colorStr);\n\n    // Hex doesn't support alpha (but will in CSS4), so force RGB if alpha is < 1.\n    const actualFormat = tinycolor(color.toString(format)).getFormat();\n    const forceRGB = actualFormat === \"hex\" && color.getAlpha() < 1;\n\n    // Create desired output color string and display it.\n    const finalColorStr = color.toString(forceRGB ? \"rgb\" : format);\n    label.innerHTML = finalColorStr;\n\n    // Notify Observable about change in value.\n    container.value = finalColorStr;\n    container.dispatchEvent(new window.Event(\"input\"));\n  };\n  setValue(defaultValue);\n\n  // Setup Pickr.\n  const setupPickr = () => {\n    new Pickr({\n      el: picker,\n      default: tinycolor(defaultValue).toString(\"rgb\"),\n      onChange: c => setValue(c.toRGBA().toString()),\n      comparison: false,\n      components: {\n        preview: false,\n        opacity: true,\n        hue: true\n      }\n    });\n  };\n\n  // For some reason, Pickr doesn't want to set the default color unless the element is mounted,\n  // so we wait for it to mount here.\n  const interval = setInterval(() => {\n    if (document.body.contains(container)) {\n      clearInterval(interval);\n      setupPickr();\n    }\n  }, 100);\n\n  return container;\n})","pinCode":false,"dname":"3c3c61a6-8c35-4604-9d5e-eeb18612b2bb","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"styles = (html`\n<link rel=\"stylesheet\" href=\"https://unpkg.com/pickr-widget@0.2.0/dist/pickr.min.css\"/>\n<style>\n  /* Make sure picker stays above other Observable elements. */\n  .pcr-app.visible {\n    z-index: 10000000;\n  }\n  /* Allow our value label to be appended with good alignment. */\n  .pickr {\n    display: inline-block;\n    vertical-align: middle;\n  }\n</style>\n`)","pinCode":false,"dname":"a9611444-1254-4a74-b2c7-7caa779890d3","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"md`## Dependencies`","pinCode":false,"dname":"0347b065-651e-4656-b143-bbe45c87bedb","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"tinycolor = (require(\"tinycolor2@1.4.1\"))","pinCode":false,"dname":"21d22c99-e7a1-4452-8519-241a656ae660","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"Pickr = (require(\"pickr-widget@0.2.0\"))","pinCode":false,"dname":"376539e1-b495-4798-b8bc-d2582c483250","codeMode":"javascript2"}}}],"version":"2.19.1"}