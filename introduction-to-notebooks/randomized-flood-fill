{"blocks":[{"type":"codeTool","data":{"codeData":{"value":"md`# Randomized Flood Fill\n\nFor each iteration, a point on the fringe is chosen randomly. Any of the four neighbors of the chosen point that are empty are assigned a similar color and added to the fringe.`","pinCode":false,"dname":"_1647272015558","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"viewof replay = (html`<button>Replay`)","pinCode":false,"dname":"_1647272015559","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"canvas = {\n  replay;\n\n  const w = width + 28, h = height;\n  const context = DOM.context2d(w, h, 1);\n  const image = context.getImageData(0, 0, w, h);\n  const indexes = [];\n  let frame = 0;\n\n  context.canvas.style.margin = \"0 -14px\";\n  context.canvas.style.imageRendering = \"pixelated\";\n  visit(w >> 1, h >> 1, 128, 128, 128);\n\n  function visit(x, y, r, g, b) {\n    if (x < 0 || x >= w || y < 0 || y >= h) return;\n    const i = y * w + x, j = i << 2;\n\tif (image.data[j + 3] === 0) {\n      image.data[j + 0] = r + (Math.random() < 0.5 ? -1 : 1);\n      image.data[j + 1] = g + (Math.random() < 0.5 ? -1 : 1);\n      image.data[j + 2] = b + (Math.random() < 0.5 ? -1 : 1);\n      image.data[j + 3] = 255;\n      indexes.push(i);\n    }\n  }\n  \n  while (indexes.length) {\n    const i = Math.random() * indexes.length | 0;\n    const j = indexes[i];\n    const k = indexes.pop();\n    if (i < indexes.length) indexes[i] = k;\n    \n    const r = image.data[(j << 2) + 0];\n    const g = image.data[(j << 2) + 1];\n    const b = image.data[(j << 2) + 2];\n    const x = j % w, y = j / w | 0;\n    visit(x - 1, y, r, g, b);\n    visit(x + 1, y, r, g, b);\n    visit(x, y - 1, r, g, b);\n    visit(x, y + 1, r, g, b);\n    \n    if (!(++frame % 1000)) {\n      context.putImageData(image, 0, 0);\n      yield context.canvas;\n    }\n  }\n\n  context.putImageData(image, 0, 0);\n  yield context.canvas;\n}","pinCode":false,"dname":"_1647272015560","codeMode":"javascript2"}}},{"type":"codeTool","data":{"codeData":{"value":"height = (600)","pinCode":false,"dname":"_1647272015561","codeMode":"javascript2"}}}],"version":"2.19.1"}